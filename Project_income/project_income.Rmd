---
title: "Introduction to linear regression"
output:
  pdf_document: default
  html_notebook: default
---

In this notebook, we show you how to perform a linear regression in R.

# Load required packages
```{r, echo=FALSE}
if("pacman" %in% rownames(installed.packages()) == FALSE) {install.packages("pacman")} # Check if you have universal installer package, install if not

pacman::p_load("caret","ROCR","lift","glmnet","MASS","e1071",'dplyr',
               "partykit","rpart", "munsell","caTools", "caret", "randomForest") #Check, and if needed install the necessary packages
```


```{r data_loading}
data_training <- read.csv("adult.data.csv")
data_testing <- read.csv("adult.test.csv")

str(data_training)
```



We create the network and a data frame containing the useful information.


```{r}
# combined_data$brand_agegroup <- 0
# combined_data$brand_agegroup[combined_data$brand_age >=0   & combined_data$brand_age <50]  <- 1
# combined_data$brand_agegroup[combined_data$brand_age >=50  & combined_data$brand_age <100] <- 2
# combined_data$brand_agegroup[combined_data$brand_age >=100 & combined_data$brand_age <150] <- 3
# combined_data$brand_agegroup[combined_data$brand_age >=150 & combined_data$brand_age <200] <- 4
# combined_data$brand_agegroup[combined_data$brand_age >=200] <- 5
# 
# combined_data$watch_agegroup <- 0
# combined_data$watch_agegroup[combined_data$watch_age >=0  & combined_data$watch_age <20]  <- 1
# combined_data$watch_agegroup[combined_data$watch_age >=20 & combined_data$watch_age <40]  <- 2
# combined_data$watch_agegroup[combined_data$watch_age >=40 & combined_data$watch_age <60]  <- 3
# combined_data$watch_agegroup[combined_data$watch_age >=60 & combined_data$watch_age <80]  <- 4
# combined_data$watch_agegroup[combined_data$watch_age >=80 & combined_data$watch_age <100] <- 5
# combined_data$watch_agegroup[combined_data$watch_age >=100] <- 6
# 
# 
# combined_data$stregth <- as.integer(combined_data$stregth)
# combined_data$degree <- as.integer(combined_data$degree)
# combined_data$brand_agegroup <- as.factor(combined_data$brand_agegroup)
# combined_data$watch_agegroup <- as.factor(combined_data$watch_agegroup)
# combined_data$brand_id <- as.factor(combined_data$brand_id)

#str(combined_data)
```


## Linear regression

Doing a linear regression is really easy in R. The command to use is lm(). The first thing to specify is y ~ x1 + x2 where y is the dependent variable and x1 and x2 are the independent variable one wants to use. The second thing to specify is the dataframe that we are going to use. Note that y, x1 and x2 are column names of this dataframe. For instance, the following looks at the relationship between the number of sent email as a function of the number of email received. The result of the linear regression is then displayed using the summary() command.

```{r}
linear_model <- lm(more_50k ~ ., data=data_training)
summary(linear_model)
```

```{r}
linear_model_glm <- glm(more_50k ~ ., data=data_training, family=binomial(link=logit))
linear_model_stepwiseAIC<-stepAIC(linear_model_glm,direction = c("both"),trace = 1)
summary(linear_model)
```

